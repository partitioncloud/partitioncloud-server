{% extends 'base.html' %}

{% block content %}
<h2>{% block title %}Détails "{{ partition.name }}"{% endblock %}</h2>
<br />

<form action="/partition/{{ partition.uuid }}/edit" method="post" enctype="multipart/form-data">
  <table>
    <tbody>
      <tr>
        <td>
          Responsable de l'ajout
        </td>
        <td>
          {% if user is not none %}
          <div class="user-profile"><!-- Completely messy html for this -->
            <div class="table-username">{{ partition_user.username }}</div>
            <div class="user-profile-picture" style="background-color:{{ partition_user.color }};" title="{{ partition_user.username }}">
              {{ partition_user.username[0] | upper }}
            </div>
          </div>
          {% else %}
            inconnu
          {% endif %}
        </td>
      </tr>
      <tr>
        <td>
          Type d'ajout
        </td>
        <td>
          {% if partition.source == "unknown" or partition.source == "upload" %}
            {{ partition.source }}
          {% else %}
            <a href="{{ partition.source }}">search</a>
          {% endif %}
        </td>
      </tr>
      <tr>
        <td>
          Albums
        </td>
        <td class="liste">
          <ul>
            {% for album in albums %}
            <li><a href="/albums/{{ album.uuid }}">{{ album.name }}</a></li>
            {% endfor %}
          </ul>
        </td>
      </tr>
      <tr>
        <td>Fichier</td>
        <td><a href="/partition/{{ partition.uuid }}"><img class="partition-thumbnail" src="/static/thumbnails/{{ partition.uuid }}.jpg"></a></td>
      </tr>
      <tr>
        <td>Titre</td>
        <td><input name="name" type="text" value="{{ partition.name }}" placeholder="Titre" required /><br/></td>
      </tr>
      <tr>
        <td>Auteur</td>
        <td><input name="author" type="text" value="{{ partition.author }}" placeholder="Auteur" /><br/></td>
      </tr>
      <tr>
        <td>Paroles</td>
        <td><textarea id="paroles" name="body" type="text" placeholder="Paroles">{{ partition.body }}</textarea><br/></td>
      </tr>
      <tr>
        <td>Pièces jointes</td>
        {% set _ = partition.load_attachments() %}
        <td><a href="/partition/{{ partition.uuid }}/attachments">
          {% if partition.attachments %}
            Oui, {{ partition.attachments | length }}
          {% else %}
            En rajouter
          {% endif %}
        </a></td>
      </tr>
    </tbody>
  </table>
  <input type="submit" value="Mettre à jour" />
</form>
<a href="/partition/{{ partition.uuid }}/delete">
  <button id="delete-partition">Supprimer</button>
</a>

{% endblock %}